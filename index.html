<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Osman'ın Yeni Savaş Oyunu</title>
    <style>
        body { margin: 0; overflow: hidden; background: #111; touch-action: none; font-family: sans-serif; }
        canvas { display: block; }
    </style>
</head>
<body>
<canvas id="game"></canvas>
<script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let player = { x: canvas.width/2, y: canvas.height/2, size: 25, color: '#00ff00', speed: 5 };
    
    // Joystick Ayarları
    let joystick = { 
        active: false, 
        baseX: 0, baseY: 0, 
        currentX: 0, currentY: 0, 
        size: 50 
    };

    canvas.addEventListener('touchstart', e => {
        joystick.active = true;
        joystick.baseX = e.touches[0].clientX;
        joystick.baseY = e.touches[0].clientY;
        joystick.currentX = joystick.baseX;
        joystick.currentY = joystick.baseY;
    });

    canvas.addEventListener('touchmove', e => {
        if (!joystick.active) return;
        joystick.currentX = e.touches[0].clientX;
        joystick.currentY = e.touches[0].clientY;

        let dx = joystick.currentX - joystick.baseX;
        let dy = joystick.currentY - joystick.baseY;
        let dist = Math.sqrt(dx*dx + dy*dy);
        let angle = Math.atan2(dy, dx);

        if (dist > 5) {
            player.x += Math.cos(angle) * player.speed;
            player.y += Math.sin(angle) * player.speed;
        }
        e.preventDefault();
    }, {passive: false});

    canvas.addEventListener('touchend', () => {
        joystick.active = false;
    });

    function drawJoystick() {
        if (!joystick.active) return;
        
        // Dış halka
        ctx.beginPath();
        ctx.arc(joystick.baseX, joystick.baseY, joystick.size, 0, Math.PI*2);
        ctx.strokeStyle = "rgba(255, 255, 255, 0.3)";
        ctx.lineWidth = 3;
        ctx.stroke();

        // İç top (hareket eden kısım)
        ctx.beginPath();
        ctx.arc(joystick.currentX, joystick.currentY, 20, 0, Math.PI*2);
        ctx.fillStyle = "rgba(255, 255, 255, 0.5)";
        ctx.fill();
    }

    function loop() {
        ctx.fillStyle = '#111';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Oyuncu
        ctx.fillStyle = player.color;
        ctx.fillRect(player.x - 12, player.y - 12, 25, 25);

        drawJoystick();
        requestAnimationFrame(loop);
    }
    loop();
</script>
</body>
</html>
